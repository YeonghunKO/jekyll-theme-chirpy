---
title: "ì½œë°±ì§€ì˜¥ì—ì„œ êµ¬ì›ë°›ê¸°2(async/await)"
date: 2020-08-27 +0800
categories: [Javascript, basics(js)]
tags: [async/await]
---

# 9. async/await ë°°ìš°ê¸°

promise ë¥¼ í†µí•´ êµ¬í˜„í•˜ê²Œ ë˜ë©´ thenì„ í†µí•´ì„œ ê³„ì†í•´ì„œ ì•ì˜ returnê°’ì„ ë°›ì•„ì™€ì•¼í•˜ê¸° ë•Œë¬¸ì— ëª…ë ¹ì´ ê¸¸ì–´ì§€ê²Œ ëœë‹¤. asyncë¥¼ ì´ìš©í•˜ë©´ í•¨ìˆ˜ì•ˆì— ê¹”ë”í•˜ê²Œ ë‹´ì•„ì„œ ì •ë¦¬ê°€ëŠ¥í•˜ë‹¤. ìš°ì„  ê³¼ì¼ì„ ë”°ëŠ” í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ ë³´ê² ë‹¤.

```javascript
// resolve ë¥¼ ì„ ì–¸í•˜ê¸°ë§Œ í•¨.
function delay(ms) {
  return new Promise((resolve) => setTimeout(resolve, ms));
}

// ìœ„ì˜ ì½”ë“œëŠ” ì•„ë˜ì˜ ì½”ë“œì™€ ê°™ë‹¤. async í‚¤ì›Œë“œëŠ” ìë™ìœ¼ë¡œ promiseë¥¼ ë§Œë“¤ì–´ì¤€ë‹¤.
async function delay(ms) {
  return setTimeout(resolve, ms);
}

// asyncëŠ” ë­ë“ ì§€ prmomiseë¥¼ return í•˜ê²Œí•œë‹¤.
//awaitëŠ” asyncì•ˆì—ì„œë§Œ ì“¸ìˆ˜ ìˆìœ¼ë©° promiseë¥¼ ê¸°ë‹¤ë¦°ë‹¤.
async function getApple() {
  // delayë¥¼ í†µí•´ resolveê°€ ì„±ë¦½ì´ ë˜ë©´ return í•˜ë„ë¡ í•˜ëŠ”ê²Œ awaití‚¤ì›Œë“œì´ë‹¤. thenì´ë‘ ê°™ì€ ì—­í• ì„ í•œë‹¤ê³  ë³´ë©´ ë¨.
  await delay(1000);
  return "ğŸ";
}

async function getBanana() {
  await delay(1000);
  return "ğŸŒ";
}
```

# 9-1. ë°”ë‚˜ë‚˜ì™€ ì‚¬ê³¼ë¥¼ ëª¨ë‘ ë”°ëŠ” í•¨ìˆ˜

ê·¸ëŸ¼ ì´ì œ ë°”ë‚˜ë‚˜ì™€ ì‚¬ê³¼ ëª¨ë‘ë¥¼ ë”°ëŠ” í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ë³´ì.

```javascript
// ë‹¤ì‹œ ì½œë°±ì§€ì˜¥ì´ ë– ì˜¤ë¦„. nestingì´ ì¤‘ë³µë˜ì§€ ì•Šë„ë¡ í•˜ëŠ”ê²Œ ì¢‹ë‹¤ í•­ìƒ.
function pickFruits() {
  return getApple().then((apple) => {
    return getBanana.then((banana) => `${apple} + ${banana}`);
  });
}

// asyncë‘ awaitë¥¼ ì‚¬ìš©í•˜ë©´ ì•ì„œ thenì„ ì²´ì´ë‹ í•œê²ƒê³¼ ê°™ì€ íš¨ê³¼ê°€ ë‚˜íƒ€ë‚œë‹¤.
// ê·¸ë˜ì„œ awaití•˜ê³  apple promiseê°€ ì„±ê³µí•˜ë©´ bananaë¡œ ë„˜ì–´ê°€ëŠ” ê²ƒì´ë‹¤.
async function pickFruits() {
  const apple = await getApple();
  const banana = await getBanana();
  return `${apple} + ${banana}`;
}
```

ê·¼ë° ì‚¬ì‹¤ìƒ appleê³¼ bananaëŠ” ì„œë¡œ ì—°ê³„ë˜ì–´ìˆëŠ” ì‘ì—…ì´ ì•„ë‹ˆë¼ì„œ ê¸°ë‹¤ë¦´ í•„ìš”ì—†ë‹¤. ê·¸ë˜ì„œ ë™ì‹œì— ì‹¤í–‰ë˜ë„ë¡ í•˜ëŠ”ê²Œ ë” ë¹ ë¥´ë‹¤.

```javascript
async function pickFruitsFast() {
  // promise ê°€ ë§Œë“¤ì–´ì§€ì ë§ˆì ì‹¤í–‰ë˜ëŠ” íŠ¹ì„±ì„ ì´ìš©í•´ì„œ ë³‘ë ¬ì ìœ¼ë¡œ ë™ì‹œì— ì‹¤í–‰í•˜ë„ë¡ í•  ìˆ˜ ìˆë‹¤.
  // ê·¸ë˜ì„œ ì‚¬ê³¼ì™€ ë°”ë‚˜ë‚˜ë¥¼ ë™ì‹œì— ë”´ë‹¤ìŒ ê¸°ë‹¤ë ¸ë‹¤ê°€ ì¶œë ¥í•˜ë©´ ëœë‹¤.
  const applePromise = getApple();
  const bananPromise = getBanana();
  const apple = await applePromise;
  const banana = await bananPromise;
  return `${apple} + ${banana}`;
}
pickFruitsFast().then(console.log);
```

# 9-3. ë” ê°„ë‹¨í•˜ê²Œ!

ê·¼ë° ì´ê²ƒ ë§ˆì €ë„ ê°„ë‹¨í•˜ê²Œ ë§Œë“¤ìˆ˜ ìˆëŠ” APIê°€ ìˆë‹¤. ë°”ë¡œ all ì´ë¼ëŠ” ê±°ë‹¤.

```javascript
async function pickAllFruits() {
  return Promise.all([getApple(), getBanana()]).then((fruits) =>
    fruits.join(" + ")
  );
}

pickAllFruits().then(console.log);

// ë˜ëŠ” ë‘˜ì¤‘ì— ë¨¼ì € ì™„ë£Œë˜ëŠ” ê²ƒì„ ë¨¼ì € return í•˜ëŠ” APIë„ ìˆë‹¤.
// ë°”ë¡œ race ë¼ëŠ” ê±°ë‹¤

async function pickFirstOne() {
  return Promise.race([getApple(), getBanana()]);
}

pickFirstOne().then(console.log);
```

ê·¸ëŸ¼. callback_to_promise ë¥¼ asyncì™€ awaitë¥¼ ì´ìš©í•´ì„œ refacotring í•´ë³´ì
